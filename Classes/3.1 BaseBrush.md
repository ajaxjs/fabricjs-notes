# BaseBrush 类文档整理（Fabric.js）
BaseBrush 是 Fabric.js 中所有画笔工具的抽象基类，定义于 `src/brushes/BaseBrush.ts:10`，为 `PencilBrush`（铅笔）、`CircleBrush`（圆形画笔）、`SprayBrush`（喷溅画笔）等具体画笔提供统一的属性和接口规范，需通过子类实现具体绘制逻辑。以下按 **类基础信息**、**构造函数**、**属性**、**方法** 分类整理为表格，便于快速查阅。


## 一、类基础信息
| 项目 | 详情 |
|------|------|
| 类名 | `BaseBrush` |
| 定义路径 | src/brushes/BaseBrush.ts:10 |
| 核心作用 | 所有画笔工具的抽象基类，定义画笔通用属性和交互接口 |
| 扩展类（子类） | `PencilBrush`、`CircleBrush`、`SprayBrush` |
| 参考资源 | [Fabric.js 画笔演示（demo）](https://fabricjs.com/demos) |


## 二、构造函数
| 构造函数 | 参数 | 返回值 | 说明 |
|----------|------|--------|------|
| `new BaseBrush(canvas)` | `canvas`: `Canvas`（必填，画笔所属的画布实例，用于绑定绘制上下文） | `BaseBrush`（新创建的 BaseBrush 实例） | 初始化画笔实例，关联到指定画布，子类实例化时需传入有效的 Canvas 对象 |


## 三、属性
所有属性为实例属性，部分提供默认值，子类可继承或重写以实现自定义画笔效果。

| 属性名 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `canvas` | `Canvas` | - | 画笔绑定的画布实例，用于获取绘制上下文（待补充更具体的类型注解） |
| `color` | `string` | `'rgb(0, 0, 0)'`（黑色） | 画笔的颜色，支持 CSS 颜色格式（如 Hex、RGB、RGBA） |
| `limitedToCanvasSize` | `boolean` | `false` | 控制自由绘制是否限制在画布尺寸内：<br>- `true`：绘制范围不可超出画布边界<br>- `false`：可在画布外绘制（默认） |
| `shadow` | `null` \| `Shadow` | `null` | 画笔笔触的阴影效果，需传入 `Shadow` 实例（包含颜色、偏移量、模糊度等）。<br>⚠️ 兼容性说明：自 v1.2.12 起，此属性替代旧版的 `shadowColor`（字符串）、`shadowOffsetX`（数字）、`shadowOffsetY`（数字）、`shadowBlur`（数字） |
| `strokeDashArray` | `null` \| `number`[] | `null` | 画笔笔触的虚线模式，如 `[5, 3]` 表示“5像素实线+3像素空白”循环；`null` 表示实线（默认） |
| `strokeLineCap` | `CanvasLineCap` | `'round'`（圆形端点） | 画笔笔触的线端样式，可选值：<br>- `'butt'`：平角端点<br>- `'round'`：圆形端点（默认）<br>- `'square'`：方形端点 |
| `strokeLineJoin` | `CanvasLineJoin` | `'round'`（圆形拐角） | 画笔笔触的拐角样式（多段线连接处），可选值：<br>- `'bevel'`：斜角拐角<br>- `'round'`：圆形拐角（默认）<br>- `'miter'`：尖角拐角 |
| `strokeMiterLimit` | `number` | `10` | 画笔笔触的最大斜接长度（仅当 `strokeLineJoin = 'miter'` 时生效），用于限制尖角拐角的延伸长度，避免过度尖锐 |
| `width` | `number` | `1`（像素） | 画笔笔触的宽度，必须为数字（不可用字符串，如 `'2'` 无效，需用 `2`） |


## 四、方法
所有方法均为 **抽象方法（abstract）**，BaseBrush 本身不实现具体逻辑，需由子类（如 `PencilBrush`）重写以实现对应交互和绘制行为。

| 方法名 | 参数 | 返回值 | 说明 |
|--------|------|--------|------|
| `_render` | - | `void` | 画笔的核心渲染方法，用于绘制笔触到画布，子类需实现具体渲染逻辑（如线条、圆形、粒子等） |
| `onMouseDown` | - `pointer`: `Point`（鼠标/触摸按下时的画布坐标点）<br>- `ev`: `TBrushEventData`（画笔事件数据，包含事件源、状态等） | `void` | 鼠标/触摸按下时触发的回调，子类需实现初始化绘制（如记录起点、开启路径） |
| `onMouseMove` | - `pointer`: `Point`（鼠标/触摸移动时的画布坐标点）<br>- `ev`: `TBrushEventData`（画笔事件数据） | `void` | 鼠标/触摸移动时触发的回调，子类需实现连续绘制（如更新路径、添加笔触） |
| `onMouseUp` | - `ev`: `TBrushEventData`（画笔事件数据） | `boolean` \| `void` | 鼠标/触摸松开时触发的回调，子类需实现绘制结束逻辑（如闭合路径、保存结果）。<br>返回值说明：`true` 表示画笔需继续阻止其他交互，`false`/`void` 表示允许后续交互 |